<template>
  <div class="d-flex flex-column flex-lg-row wrapper" style="flex: 1">
    <div class="flex-column layer-column">
      <v-row class="d-flex">
        <v-col id="job_number" class="m-3 mb-2 text-h5">
          {{ job.name || "-" }}
        </v-col>
        <v-col class="m-4" style="max-width: 150px">
          <v-tooltip bottom>
            <template v-slot:activator="{ on }">
              <v-btn
                class="float-right"
                outlined
                v-on="on"
                style="padding-left: 10px; padding-right: 7px"
                v-on:click="
                  downloadItem('output.log', 'output.log', 'text/html')
                "
              >
                Protocol
                <v-icon>mdi-download</v-icon>
              </v-btn>
            </template>
            <span>
              Here you can download <br />
              a log file, written <br />
              by the R-code while <br />
              the calculations are <br />
              running.
            </span>
          </v-tooltip>
        </v-col>
      </v-row>

      <v-row class="ml-1">
        <v-col cols="12">
          <v-switch
            v-model="colorblindMode"
            label="Switch to Color Blind Mode (Trichromacy)"
            v-on:change="switchMode"
          ></v-switch
        ></v-col>
      </v-row>

      <v-simple-table>
        <tbody>
          <template v-if="aoiLayer != null">
            <tr id="not_last_td">
              <td id="td_elements_with_slider">
                Area of Interest (AOI)
                <vue-slider
                  v-model="aoiTransparency"
                  v-on:change="changeOpacity('aoi')"
                  :minRange="0"
                  :maxRange="10"
                />
                <p style="font-size: 10px">Transparency</p>
                <vue-slider
                  v-model="aoiLineThickness"
                  v-on:change="changeLineThickness('aoi')"
                  :data="[0, 1, 2, 3, 4, 5]"
                  :marks="true"
                  :hide-label="true"
                />
                <p style="font-size: 10px">Line thickness</p>
              </td>
              <td class="check justify-center align-start">
                <div class="d-flex align-items-center">
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-simple-checkbox
                        id="aoi"
                        v-on:click="switchLayer('aoi')"
                        color="primary"
                        v-on="on"
                        v-bind="attrs"
                        v-model="aoiCheckbox"
                        v-ripple
                      ></v-simple-checkbox>
                    </template>
                    <span>Show/Hide</span>
                  </v-tooltip>
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-btn
                        class="ms-2"
                        icon
                        v-on:click="zoomToLayer('aoi')"
                        v-bind="attrs"
                        v-on="on"
                      >
                        <v-icon>mdi-magnify</v-icon>
                      </v-btn>
                    </template>
                    <span>Zoom to layer</span>
                  </v-tooltip>
                </div>
              </td>
            </tr>
          </template>
          <template v-if="aoiLayer === null">
            <v-tooltip left color="error">
              <template v-slot:activator="{ on }">
                <tr id="not_last_td" v-on="on">
                  <td id="td_elements_with_slider" style="color: #a7a7a7">
                    Area of Interest (AOI)
                    <vue-slider
                      disabled
                      v-model="aoiTransparency"
                      v-on:change="changeOpacity('aoi')"
                      :minRange="0"
                      :maxRange="10"
                    />
                    <p style="font-size: 10px">Transparency</p>
                    <vue-slider
                      disabled
                      v-model="aoiLineThickness"
                      v-on:change="changeLineThickness('aoi')"
                      :data="[0, 1, 2, 3, 4, 5]"
                      :marks="true"
                      :hide-label="true"
                    />
                    <p style="font-size: 10px">Line thickness</p>
                  </td>
                  <td class="check justify-center align-start">
                    <div class="d-flex align-items-center">
                      <v-simple-checkbox
                        id="aoi"
                        color="primary"
                        v-model="aoiCheckbox"
                        v-ripple
                        disabled
                      ></v-simple-checkbox>
                      <v-tooltip bottom>
                        <template v-slot:activator="{ on, attrs }">
                          <v-btn
                            class="ms-2"
                            icon
                            disabled
                            v-on:click="zoomToLayer('aoi')"
                            v-bind="attrs"
                            v-on="on"
                          >
                            <v-icon>mdi-magnify</v-icon>
                          </v-btn>
                        </template>
                        <span>Zoom to layer</span>
                      </v-tooltip>
                    </div>
                  </td>
                </tr>
              </template>
              <span>This Layer is not available</span>
            </v-tooltip>
          </template>
          <template v-if="diLayer != null">
            <tr id="not_last_td">
              <td id="td_elements_with_slider">
                Dissimilarity Index
                <vue-slider
                  v-model="diTransparency"
                  v-on:change="changeOpacity('di')"
                  :tooltip-formatter="sliderPercentage"
                />
                <p style="font-size: 10px">Transparency</p>

                <template v-if="colorblindMode == false">
                  <ColorLegend scale="Viridis" :steps="6" :fixed="1" />
                </template>
                <template v-if="colorblindMode == true">
                  <ColorLegend
                    :scale="[
                      '#ffff00',
                      '#ffaf00',
                      '#ff5634',
                      '#e9005d',
                      '#9a0079',
                      '#000080',
                    ]"
                    :steps="6"
                    :fixed="1"
                  />
                </template>
              </td>
              <td>
                <div class="d-flex align-items-center">
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-simple-checkbox
                        id="di"
                        v-on:click="switchLayer('di')"
                        color="primary"
                        v-on="on"
                        v-bind="attrs"
                        v-model="diCheckbox"
                        v-ripple
                      ></v-simple-checkbox>
                    </template>
                    <span>Show/Hide</span>
                  </v-tooltip>
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-btn
                        class="ms-2"
                        icon
                        v-on:click="zoomToLayer('di')"
                        v-bind="attrs"
                        v-on="on"
                      >
                        <v-icon>mdi-magnify</v-icon>
                      </v-btn>
                    </template>
                    <span>Zoom to layer</span>
                  </v-tooltip>
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-btn
                        class="ms-2"
                        icon
                        v-on:click="
                          downloadItem('aoa_di.tif', 'aoa_di', 'image/tiff')
                        "
                        v-bind="attrs"
                        v-on="on"
                      >
                        <v-icon>mdi-download</v-icon>
                      </v-btn>
                    </template>
                    <span>Download</span>
                  </v-tooltip>
                </div>
              </td>
            </tr>
          </template>
          <template v-if="diLayer === null">
            <v-tooltip left color="error">
              <template v-slot:activator="{ on }">
                <tr id="not_last_td" v-on="on">
                  <td id="td_elements_with_slider" style="color: #a7a7a7">
                    Dissimilarity Index
                    <vue-slider
                      :disabled="true"
                      v-model="diTransparency"
                      v-on:change="changeOpacity('di')"
                      :tooltip-formatter="sliderPercentage"
                    />
                    <p style="font-size: 10px">Transparency</p>
                    <template v-if="colorblindMode == false">
                      <ColorLegend scale="Viridis" :steps="6" :fixed="1" />
                    </template>
                    <template v-if="colorblindMode == true">
                      <ColorLegend
                        :scale="[
                          '#ffff00',
                          '#ffaf00',
                          '#ff5634',
                          '#e9005d',
                          '#9a0079',
                          '#000080',
                        ]"
                        :steps="6"
                        :fixed="1"
                      />
                    </template>
                  </td>
                  <td>
                    <div class="d-flex align-items-center">
                      <v-simple-checkbox
                        id="di"
                        color="primary"
                        v-model="diCheckbox"
                        v-ripple
                        disabled
                      ></v-simple-checkbox>

                      <v-tooltip bottom>
                        <template v-slot:activator="{ on, attrs }">
                          <v-btn
                            class="ms-2"
                            icon
                            disabled
                            v-on:click="zoomToLayer('di')"
                            v-bind="attrs"
                            v-on="on"
                          >
                            <v-icon>mdi-magnify</v-icon>
                          </v-btn>
                        </template>
                        <span>Zoom to layer</span>
                      </v-tooltip>
                      <v-tooltip bottom>
                        <template v-slot:activator="{ on, attrs }">
                          <v-btn
                            class="ms-2"
                            icon
                            disabled
                            v-on:click="
                              downloadItem('aoa_di.tif', 'aoa_di', 'image/tiff')
                            "
                            v-bind="attrs"
                            v-on="on"
                          >
                            <v-icon>mdi-download</v-icon>
                          </v-btn>
                        </template>
                        <span>Download</span>
                      </v-tooltip>
                    </div>
                  </td>
                </tr>
              </template>
              <span>This Layer is not available</span>
            </v-tooltip>
          </template>
          <template v-if="predLayer != null">
            <tr id="not_last_td">
              <td id="td_elements_with_slider">
                Prediction / Classification
                <vue-slider
                  v-model="predTransparency"
                  v-on:change="changeOpacity('pred')"
                  :tooltip-formatter="sliderPercentage"
                />
                <p style="font-size: 10px">Transparency</p>

                <div class="d-flex flex-column">
                  <template v-if="colorblindMode == false">
                    <div
                      v-for="(value, index) in predClassificationColors"
                      :key="value"
                      class="d-flex align-items-center mb-1"
                    >
                      <div
                        :style="{
                          width: '20px',
                          height: '20px',
                          backgroundColor: value,
                          boxShadow: '0 0 1px #333',
                        }"
                      ></div>
                      <div class="ml-3">{{ resultJson[0][index] }}</div>
                    </div>
                  </template>
                  <template v-if="colorblindMode == true">
                    <div
                      v-for="(value, index) in colorblindScalePred"
                      :key="value"
                      class="d-flex align-items-center mb-1"
                    >
                      <div
                        :style="{
                          width: '20px',
                          height: '20px',
                          backgroundColor: value,
                          boxShadow: '0 0 1px #333',
                        }"
                      ></div>
                      <div class="ml-3">{{ resultJson[0][index] }}</div>
                    </div>
                  </template>
                </div>
              </td>
              <td>
                <div class="d-flex align-items-center">
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-simple-checkbox
                        id="pred"
                        v-on:click="switchLayer('pred')"
                        color="primary"
                        v-on="on"
                        v-bind="attrs"
                        v-model="predCheckbox"
                        v-ripple
                      ></v-simple-checkbox>
                    </template>
                    <span>Show/Hide</span>
                  </v-tooltip>
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-btn
                        class="ms-2"
                        icon
                        v-on:click="zoomToLayer('pred')"
                        v-bind="attrs"
                        v-on="on"
                      >
                        <v-icon>mdi-magnify</v-icon>
                      </v-btn>
                    </template>
                    <span>Zoom to layer</span>
                  </v-tooltip>
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-btn
                        class="ms-2"
                        icon
                        v-on:click="
                          downloadItem('pred.tif', 'pred', 'image/tiff')
                        "
                        v-bind="attrs"
                        v-on="on"
                      >
                        <v-icon>mdi-download</v-icon>
                      </v-btn>
                    </template>
                    <span>Download</span>
                  </v-tooltip>
                </div>
              </td>
            </tr>
          </template>
          <template v-if="predLayer === null">
            <v-tooltip left color="error">
              <template v-slot:activator="{ on }">
                <tr id="not_last_td" v-on="on">
                  <td id="td_elements_with_slider" style="color: #a7a7a7">
                    Prediction / Classification
                    <vue-slider
                      disabled
                      v-model="predTransparency"
                      v-on:change="changeOpacity('pred')"
                      :tooltip-formatter="sliderPercentage"
                    />
                    <p style="font-size: 10px">Transparency</p>
                  </td>
                  <td>
                    <div class="d-flex align-items-center">
                      <v-simple-checkbox
                        id="pred"
                        color="primary"
                        v-model="predCheckbox"
                        v-ripple
                        disabled
                      ></v-simple-checkbox>
                      <v-tooltip bottom>
                        <template v-slot:activator="{ on, attrs }">
                          <v-btn
                            class="ms-2"
                            icon
                            disabled
                            v-on:click="zoomToLayer('pred')"
                            v-bind="attrs"
                            v-on="on"
                          >
                            <v-icon>mdi-magnify</v-icon>
                          </v-btn>
                        </template>
                        <span>Zoom to layer</span>
                      </v-tooltip>
                      <v-tooltip bottom>
                        <template v-slot:activator="{ on, attrs }">
                          <v-btn
                            class="ms-2"
                            icon
                            disabled
                            v-on:click="
                              downloadItem('pred.tif', 'pred', 'image/tiff')
                            "
                            v-bind="attrs"
                            v-on="on"
                          >
                            <v-icon>mdi-download</v-icon>
                          </v-btn>
                        </template>
                        <span>Download</span>
                      </v-tooltip>
                    </div>
                  </td>
                </tr>
              </template>
              <span>This Layer is not available</span>
            </v-tooltip>
          </template>
          <template v-if="aoaLayer != null">
            <tr id="not_last_td">
              <td id="td_elements_with_slider">
                Area of Applicability (AOA)
                <vue-slider
                  v-model="aoaTransparency"
                  v-on:change="changeOpacity('aoa')"
                  :tooltip-formatter="sliderPercentage"
                />
                <p style="font-size: 10px">Transparency</p>

                <template v-if="colorblindMode == false">
                  <ColorLegend
                    :scale="['#cf1f8f', '#ffffff']"
                    :steps="2"
                    :fixed="0"
                  />
                </template>
                <template v-if="colorblindMode == true">
                  <ColorLegend
                    :scale="['#21A7E6', '#ffffff']"
                    :steps="2"
                    :fixed="0"
                  />
                </template>
              </td>
              <td>
                <div class="d-flex align-items-center">
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-simple-checkbox
                        id="aoa"
                        v-on:click="switchLayer('aoa')"
                        color="primary"
                        v-on="on"
                        v-bind="attrs"
                        v-model="aoaCheckbox"
                        v-ripple
                      ></v-simple-checkbox>
                    </template>
                    <span>Show/Hide</span>
                  </v-tooltip>
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-btn
                        class="ms-2"
                        icon
                        v-on:click="zoomToLayer('aoa')"
                        v-bind="attrs"
                        v-on="on"
                      >
                        <v-icon>mdi-magnify</v-icon>
                      </v-btn>
                    </template>
                    <span>Zoom to layer</span>
                  </v-tooltip>
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-btn
                        class="ms-2"
                        icon
                        v-on:click="
                          downloadItem('aoa_aoa.tif', 'aoa_aoa', 'image/tiff')
                        "
                        v-bind="attrs"
                        v-on="on"
                      >
                        <v-icon>mdi-download</v-icon>
                      </v-btn>
                    </template>
                    <span>Download</span>
                  </v-tooltip>
                </div>
              </td>
            </tr>
          </template>
          <template v-if="aoaLayer === null">
            <v-tooltip left color="error">
              <template v-slot:activator="{ on }">
                <tr id="not_last_td" v-on="on">
                  <td id="td_elements_with_slider" style="color: #a7a7a7">
                    Area of Applicability (AOA)
                    <vue-slider
                      disabled
                      v-model="aoaTransparency"
                      v-on:change="changeOpacity('aoa')"
                      :tooltip-formatter="sliderPercentage"
                    />
                    <p style="font-size: 10px">Transparency</p>

                    <template v-if="colorblindMode == false">
                      <ColorLegend
                        :scale="['#cf1f8f', '#ffffff']"
                        :steps="2"
                        :fixed="0"
                      />
                    </template>
                    <template v-if="colorblindMode == true">
                      <ColorLegend
                        :scale="['#21A7E6', '#ffffff']"
                        :steps="2"
                        :fixed="0"
                      />
                    </template>
                  </td>
                  <td>
                    <div class="d-flex align-items-center">
                      <v-simple-checkbox
                        id="aoa"
                        color="primary"
                        v-model="aoaCheckbox"
                        v-ripple
                        disabled
                      ></v-simple-checkbox>
                      <v-tooltip bottom>
                        <template v-slot:activator="{ on, attrs }">
                          <v-btn
                            class="ms-2"
                            icon
                            disabled
                            v-on:click="zoomToLayer('aoa')"
                            v-bind="attrs"
                            v-on="on"
                          >
                            <v-icon>mdi-magnify</v-icon>
                          </v-btn>
                        </template>
                        <span>Zoom to layer</span>
                      </v-tooltip>
                      <v-tooltip bottom>
                        <template v-slot:activator="{ on, attrs }">
                          <v-btn
                            class="ms-2"
                            icon
                            disabled
                            v-on:click="
                              downloadItem(
                                'aoa_aoa.tif',
                                'aoa_aoa',
                                'image/tiff'
                              )
                            "
                            v-bind="attrs"
                            v-on="on"
                          >
                            <v-icon>mdi-download</v-icon>
                          </v-btn>
                        </template>
                        <span>Download</span>
                      </v-tooltip>
                    </div>
                  </td>
                </tr>
              </template>
              <span>This Layer is not available</span>
            </v-tooltip>
          </template>
          <template v-if="samplePolygonsLayer != null">
            <tr id="last_td">
              <td id="td_elements_with_slider">
                Sample Polygons
                <vue-slider
                  v-model="samplePolygonsTransparency"
                  v-on:change="changeOpacity('samplePolygons')"
                  :tooltip-formatter="sliderPercentage"
                />
                <p style="font-size: 10px">Transparency</p>
                <vue-slider
                  v-model="samplePolygonsLineThickness"
                  v-on:change="changeLineThickness('samplePolygons')"
                  :data="[0, 1, 2, 3, 4, 5]"
                  :marks="true"
                  :hide-label="true"
                />
                <p style="font-size: 10px">Line thickness</p>
              </td>
              <td>
                <div class="d-flex align-items-center">
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-simple-checkbox
                        id="samplePolygons"
                        v-on:click="switchLayer('samplePolygons')"
                        color="primary"
                        v-on="on"
                        v-bind="attrs"
                        v-model="samplePolygonsCheckbox"
                        v-ripple
                      ></v-simple-checkbox>
                    </template>
                    <span>Show/Hide</span>
                  </v-tooltip>
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-btn
                        class="ms-2"
                        icon
                        v-on:click="zoomToLayer('samplePolygons')"
                        v-bind="attrs"
                        v-on="on"
                      >
                        <v-icon>mdi-magnify</v-icon>
                      </v-btn>
                    </template>
                    <span>Zoom to layer</span>
                  </v-tooltip>
                </div>
              </td>
            </tr>
          </template>
          <template v-if="samplePolygonsLayer === null">
            <v-tooltip left color="error">
              <template v-slot:activator="{ on }">
                <tr id="last_td" v-on="on">
                  <td id="td_elements_with_slider" style="color: #a7a7a7">
                    Sample Polygons
                    <vue-slider
                      disabled
                      v-model="samplePolygonsTransparency"
                      v-on:change="changeOpacity('samplePolygons')"
                      :tooltip-formatter="sliderPercentage"
                    />
                    <p style="font-size: 10px">Transparency</p>
                    <vue-slider
                      disabled
                      v-model="samplePolygonsLineThickness"
                      v-on:change="changeLineThickness('samplePolygons')"
                      :data="[0, 1, 2, 3, 4, 5]"
                      :marks="true"
                      :hide-label="true"
                    />
                    <p style="font-size: 10px">Line thickness</p>
                  </td>
                  <td>
                    <div class="d-flex align-items-center">
                      <v-simple-checkbox
                        id="samplePolygons"
                        color="primary"
                        v-model="samplePolygonsCheckbox"
                        v-ripple
                        disabled
                      ></v-simple-checkbox>
                      <v-tooltip bottom>
                        <template v-slot:activator="{ on, attrs }">
                          <v-btn
                            class="ms-2"
                            icon
                            disabled
                            v-on:click="zoomToLayer('samplePolygons')"
                            v-bind="attrs"
                            v-on="on"
                          >
                            <v-icon>mdi-magnify</v-icon>
                          </v-btn>
                        </template>
                        <span>Zoom to layer</span>
                      </v-tooltip>
                    </div>
                  </td>
                </tr></template
              >
              <span>This Layer is not available</span>
            </v-tooltip>
          </template>
          <template v-if="suggestionLayer != null">
            <tr id="not_last_td" style="height: 60px">
              <td class="pt-4">Suggested locations for training polygons</td>
              <td class="pt-4">
                <div class="d-flex align-items-center">
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-simple-checkbox
                        id="suggestion"
                        v-on:click="switchLayer('suggestion')"
                        color="primary"
                        v-on="on"
                        v-bind="attrs"
                        v-model="suggestionCheckbox"
                        v-ripple
                      ></v-simple-checkbox>
                    </template>
                    <span>Show/Hide</span>
                  </v-tooltip>
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-btn
                        class="ms-2"
                        icon
                        v-on:click="zoomToLayer('suggestion')"
                        v-bind="attrs"
                        v-on="on"
                      >
                        <v-icon>mdi-magnify</v-icon>
                      </v-btn>
                    </template>
                    <span>Zoom to layer</span>
                  </v-tooltip>
                  <v-tooltip bottom>
                    <template v-slot:activator="{ on, attrs }">
                      <v-btn
                        class="ms-2"
                        icon
                        v-on:click="
                          downloadItem(
                            'suggestion.geojson',
                            'suggestion',
                            'application/json'
                          )
                        "
                        v-bind="attrs"
                        v-on="on"
                      >
                        <v-icon>mdi-download</v-icon>
                      </v-btn>
                    </template>
                    <span>Download</span>
                  </v-tooltip>
                </div>
              </td>
            </tr>
          </template>
          <template v-if="suggestionLayer === null">
            <v-tooltip left color="error">
              <template v-slot:activator="{ on }">
                <tr id="not_last_td" v-on="on">
                  <td style="color: #a7a7a7">
                    Suggested locations for training polygons
                  </td>
                  <td>
                    <div class="d-flex align-items-center">
                      <v-simple-checkbox
                        id="suggestion"
                        color="primary"
                        v-model="suggestionCheckbox"
                        v-ripple
                        disabled
                      ></v-simple-checkbox>
                      <v-tooltip bottom>
                        <template v-slot:activator="{ on, attrs }">
                          <v-btn
                            class="ms-2"
                            icon
                            disabled
                            v-on:click="zoomToLayer('suggestion')"
                            v-bind="attrs"
                            v-on="on"
                          >
                            <v-icon>mdi-magnify</v-icon>
                          </v-btn>
                        </template>
                        <span>Zoom to layer</span>
                      </v-tooltip>
                      <v-tooltip bottom>
                        <template v-slot:activator="{ on, attrs }">
                          <v-btn
                            class="ms-2"
                            icon
                            disabled
                            v-on:click="
                              downloadItem(
                                'suggestion.geojson',
                                'suggestion',
                                'application/json'
                              )
                            "
                            v-bind="attrs"
                            v-on="on"
                          >
                            <v-icon>mdi-download</v-icon>
                          </v-btn>
                        </template>
                        <span>Download</span>
                      </v-tooltip>
                    </div>
                  </td>
                </tr>
              </template>
              <span>This Layer is not available</span>
            </v-tooltip>
          </template>
        </tbody>
      </v-simple-table>
      <v-divider> </v-divider>
      <template v-if="kappaIndex === null">
        <v-tooltip left color="error">
          <template v-slot:activator="{ on }">
            <v-row justify="center" v-on="on">
              <v-expansion-panels flat accordion disabled class="pb-7">
                <v-expansion-panel>
                  <v-expansion-panel-header class="pl-4" style="font-size: 14px"
                    >Details</v-expansion-panel-header
                  >
                  <v-expansion-panel-content> </v-expansion-panel-content>
                </v-expansion-panel>
              </v-expansion-panels> </v-row
          ></template>
          <span>These informations are not available</span>
        </v-tooltip>
      </template>
      <template v-if="kappaIndex != null">
        <v-expansion-panels flat accordion class="pb-7">
          <v-expansion-panel>
            <v-expansion-panel-header class="pl-4" style="font-size: 14px"
              >Details</v-expansion-panel-header
            >
            <v-expansion-panel-content>
              <div class="mb-1" style="font-size: 14px">
                Accuracy: {{ accuracy }}
              </div>
              <div class="mb-1" style="font-size: 14px">
                Kappa Index: {{ kappaIndex }}
              </div>
              <v-tooltip bottom>
                <template v-slot:activator="{ on }">
                  <v-btn
                    v-on="on"
                    dark
                    class="float-left mt-3 mr-2 mb-2"
                    style="padding-left: 10px; padding-right: 7px"
                    v-on:click="
                      downloadItem(
                        'model.rds',
                        'model.rds',
                        'application/octet-stream'
                      )
                    "
                  >
                    Model
                    <v-icon>mdi-download</v-icon>
                  </v-btn>
                </template>
                <span>Download the trained model</span>
              </v-tooltip>
              <v-tooltip bottom>
                <template v-slot:activator="{ on }">
                  <v-btn
                    v-on="on"
                    dark
                    class="float-left mt-3 mb-2"
                    style="padding-left: 10px; padding-right: 7px"
                    v-on:click="
                      downloadItem(
                        'job_param.json',
                        'job_param.json',
                        'application/json'
                      )
                    "
                  >
                    Job parameters
                    <v-icon>mdi-download</v-icon>
                  </v-btn>
                </template>
                <span>Download the job parameters</span>
              </v-tooltip>
            </v-expansion-panel-content>
          </v-expansion-panel>
        </v-expansion-panels>
      </template>
    </div>
    <div class="d-flex align-stretch bg-light" style="flex: 1">
      <div id="map-container"></div>
    </div>
  </div>
</template>

<script>
// Import that are required for the following functionalities
import "leaflet/dist/leaflet.css";
import L from "leaflet";
import "leaflet/dist/leaflet.css";

import parseGeoraster from "georaster";
import GeoRasterLayer from "georaster-layer-for-leaflet";

import ColorLegend from "@/components/ColorLegend";

import { mapState } from "vuex";
import * as API from "@/common/api";

import VueSlider from "vue-slider-component";
import "vue-slider-component/theme/antd.css";

import chroma from "chroma-js";

import markerPng from "@/assets/markerIconRedCrossWithBlackEvenThicker.png";

export default {
  name: "Output",
  computed: mapState({
    jobId() {
      // Getting job based on the router parameter (see vue-router):
      const { jobId = "" } = this.$route.params;
      return jobId;
    },
    job(state) {
      return state.jobs[this.jobId] || {};
    },
  }),
  data: () => ({
    map: null,
    tileLayer: null,
    earthLayer: null,
    colorblindLayer: null,
    // Everything needed to visualize the aoi.geojson.
    aoiCheckbox: false,
    aoiJson: "aoi.geojson",
    aoiLayer: null,
    aoiTransparency: 50,
    aoiLineThickness: 1,
    // Everything needed to visualize the aoi_di.tif.
    diCheckbox: false,
    diUrl: "aoa_di.tif",
    diLayer: null,
    diLayerColorblind: null,
    diTransparency: 100,
    georasterDi: null,
    // Everything needed to visualize the pred.tif.
    predCheckbox: false,
    predUrl: "pred.tif",
    predLayer: null,
    predLayerColorblind: null,
    predTransparency: 100,
    georasterPred: null,
    // Generated by chromajs, e.g.: ['#9e0142', '#f98e52', ...]
    predClassificationColors: [],
    colorblindScalePred: [],
    // Everything needed to visualize the aoi_aoa.tif.
    aoaCheckbox: false,
    aoaUrl: "aoa_aoa.tif",
    aoaLayer: null,
    aoaLayerColorblind: null,
    aoaTransparency: 100,
    georasterAoa: null,
    // Everything needed to visualize the samplePolygons.geojson.
    samplePolygonsCheckbox: false,
    samplePolygonsJson: "samples.geojson",
    samplePolygonsLayer: null,
    samplePolygonsTransparency: 50,
    samplePolygonsLineThickness: 1,
    // Everything needed to visualize the suggestion.geojson.
    suggestionCheckbox: false,
    suggestionJson: "suggestion.geojson",
    suggestionLayer: null,
    // Causes the percentage scale of the slider component.
    sliderPercentage: "{value} %",
    resultJsonUrl: "result.json",
    resultJson: null,
    kappaIndex: null,
    accuracy: null,
    outputLogUrl: "output.log",
    // Color blind mode
    colorblindMode: false,
  }),
  components: {
    VueSlider,
    ColorLegend,
  },
  methods: {
    /**
     * This function will change the basemap and all layers into a colorblind version.
     */
    switchMode: async function () {
      if (this.colorblindMode === false) {
        this.tileLayer = L.tileLayer(
          "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
          {
            attribution:
              '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
          }
        ).addTo(this.map);

        if (this.aoiLayer != null) {
          this.aoiLayer.setStyle({
            color: "#3388ff",
          });
        }
        if (this.diLayer != null && this.diCheckbox == true) {
          this.map.removeLayer(this.diLayerColorblind);
          this.diLayer.addTo(this.map);
        }
        if (this.predLayer != null && this.predCheckbox == true) {
          this.map.removeLayer(this.predLayerColorblind);
          this.predLayer.addTo(this.map);
        }
        if (this.aoaLayer != null && this.aoaCheckbox == true) {
          this.map.removeLayer(this.aoaLayerColorblind);
          this.aoaLayer.addTo(this.map);
        }
        if (this.samplePolygonsLayer != null) {
          this.samplePolygonsLayer.setStyle({
            color: "#3388ff",
          });
        }
      } else if (this.colorblindMode === true) {
        this.tileLayer = L.tileLayer(
          //"https://tile.jawg.io/e05fd39a-c48d-4fe7-865e-75b940afcb34/{z}/{x}/{y}{r}.png?access-token=f8JszPWTpbAxBEKElUVA7DJcC7Rrzg8hm36s98r2dV7SFWWvoP6v0E9BTxGttjZZ",
          "https://{s}.tile.jawg.io/jawg-light/{z}/{x}/{y}{r}.png?access-token=f8JszPWTpbAxBEKElUVA7DJcC7Rrzg8hm36s98r2dV7SFWWvoP6v0E9BTxGttjZZ",
          {
            attribution:
              //'<a href="https://www.jawg.io" target="_blank">&copy; Jawg</a> - <a href="https://www.openstreetmap.org" target="_blank">&copy; OpenStreetMap</a>&nbsp;contributors',
              '<a href="http://jawg.io" title="Tiles Courtesy of Jawg Maps" target="_blank">&copy; <b>Jawg</b>Maps</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
          }
        ).addTo(this.map);

        if (this.aoiLayer != null) {
          this.aoiLayer.setStyle({
            color: "#FF4452",
          });
        }
        if (this.diLayerColorblind != null && this.diCheckbox == true) {
          this.map.removeLayer(this.diLayer);
          this.diLayerColorblind.addTo(this.map);
        }
        if (this.predLayerColorblind != null && this.predCheckbox == true) {
          this.map.removeLayer(this.predLayer);
          this.predLayerColorblind.addTo(this.map);
        }
        if (this.aoaLayerColorblind != null && this.aoaCheckbox == true) {
          this.map.removeLayer(this.aoaLayer);
          this.aoaLayerColorblind.addTo(this.map);
        }
        if (this.samplePolygonsLayer != null) {
          this.samplePolygonsLayer.setStyle({
            color: "#FF4452",
          });
        }
      }
    },
    /**
     * This function initializes the leaflet map with an osm tile layer and focused on Münster.
     */
    initMap: function () {
      this.map = L.map("map-container", {
        layers: this.tileLayer,
      }).setView([51.966, 7.633], 10);

      // To make sure, that the two basement options lie underneath the outputlayers which should be visualized,
      // a Pane with a z-Index gets created, which makes sure they will always lie underneath.
      this.map.createPane("basemap");
      this.map.getPane("basemap").style.zIndex = 10;
      // To keep sure the tiles are not able to grab this line gets added.
      this.map.getPane("basemap").style.pointerEvents = "none";

      // First the osm layer gets initialized.
      const osmUrl = "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png";
      const osmAttr =
        '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';
      // Afterwards the world imagery layer gets initialized.
      const earthUrl =
        "https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}";
      const earthAttr =
        "Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community";
      // Colorblind layer basemap
      const colorblindUrl =
        "https://tile.jawg.io/e05fd39a-c48d-4fe7-865e-75b940afcb34/{z}/{x}/{y}{r}.png?access-token=f8JszPWTpbAxBEKElUVA7DJcC7Rrzg8hm36s98r2dV7SFWWvoP6v0E9BTxGttjZZ";
      const colorblindAttr =
        '<a href="https://www.jawg.io" target="_blank">&copy; Jawg</a> - <a href="https://www.openstreetmap.org" target="_blank">&copy; OpenStreetMap</a>&nbsp;contributors';

      this.tileLayer = L.tileLayer(osmUrl, {
        attribution: osmAttr,
        pane: "basemap", // Both layers are added to the basemap-pane.
      }).addTo(this.map);

      this.earthLayer = L.tileLayer(earthUrl, {
        attribution: earthAttr,
        pane: "basemap", // Both layers are added to the basemap-pane.
      });

      this.colorblindLayer = L.tileLayer(colorblindUrl, {
        attribution: colorblindAttr,
        subdomains: "abcd",
      });

      const basemaps = {
        "Open Street Map": this.tileLayer,
        "Colorblind map": this.colorblindLayer,
      };
      const overlayMaps = { "World Imagery": this.earthLayer };

      // At last a layer control must be added to switch between multiple basemaps.
      L.control.layers(basemaps, overlayMaps).addTo(this.map);
    },
    /**
     * This function triggers the downlad process of the results of the calculations.
     * @param {string} urlLink -  Contains the internal URL to the file.
     * @param {string} label - Contains the label the downloaded file should get.
     */
    downloadItem: async function (urlLink, label, type) {
      let response = await API.getJobFile(this.jobId, urlLink, {
        responseType: "blob",
      });
      const blob = new Blob([response.data], { type: type });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = label;
      link.click();
      URL.revokeObjectURL(link.href);
    },
    /**
     * This function checks whether a requested layer exists or not
     * @param {GeoRasterLayer / GeoJson} layer - This parameter contains the requested layer.
     * @return {Boolean} - It returns true, if the layer eists and false if not.
     */
    checkLayerGetsFoundWithMessage: function (layer) {
      if (layer == null) {
        console.log("Dieser Layer existiert nicht");
        return false;
      } else return true;
    },
    /**
     * This function changes the opacity when triggered through a button.
     * @param {string} layerId - The layerId must be given to change the opacity for the right layer.
     */
    changeOpacity: function (layerId) {
      if (layerId == "aoi") {
        this.aoiLayer.setStyle({
          fillOpacity: this.aoiTransparency / 100,
        });
      } else if (layerId == "aoa") {
        this.aoaLayer.setOpacity(this.aoaTransparency / 100);
        this.aoaLayerColorblind.setOpacity(this.aoaTransparency / 100);
      } else if (layerId == "di") {
        this.diLayer.setOpacity(this.diTransparency / 100);
        this.diLayerColorblind.setOpacity(this.diTransparency / 100);
      } else if (layerId == "pred") {
        this.predLayer.setOpacity(this.predTransparency / 100);
        this.predLayerColorblind.setOpacity(this.predTransparency / 100);
      } else if (layerId == "samplePolygons") {
        this.samplePolygonsLayer.setStyle({
          fillOpacity: this.samplePolygonsTransparency / 100,
        });
      }
    },
    /**
     * This function changes the line thickness of the polygons in a GeoJson layer.
     * @param {string} layerId - The layerId must be given to change the line thickness for the right layer.
     */
    changeLineThickness: function (layerId) {
      if (layerId == "aoi") {
        this.aoiLayer.setStyle({
          weight: this.aoiLineThickness,
        });
      } else if (layerId == "samplePolygons") {
        this.samplePolygonsLayer.setStyle({
          weight: this.samplePolygonsLineThickness,
        });
      }
    },
    /**
     * This function (de-)activates the layer when it gets triffered by the Show/Hide checkbox.
     * @param {string} id - The id is needed to know which layer got triggered.
     */
    switchLayer: function (id) {
      if (id == "aoi") {
        if (!this.checkLayerGetsFoundWithMessage(this.aoiLayer))
          throw "ERROR - Dieser Layer exisitiert nicht!";

        if (this.aoiCheckbox == true) {
          this.aoiLayer.addTo(this.map);
          this.map.fitBounds(this.aoiLayer.getBounds());
        } else if (this.aoiCheckbox == false) {
          this.map.removeLayer(this.aoiLayer);
        }
      } else if (id == "di") {
        if (!this.checkLayerGetsFoundWithMessage(this.diLayer))
          throw "ERROR - Dieser Layer exisitiert nicht!";
        if (this.diCheckbox == true) {
          if (this.colorblindMode == false) {
            this.diLayer.addTo(this.map);
            this.map.fitBounds(this.diLayer.getBounds());
          } else if (this.colorblindMode == true) {
            this.diLayerColorblind.addTo(this.map);
            this.map.fitBounds(this.diLayerColorblind.getBounds());
          }
        } else if (this.diCheckbox == false) {
          if (this.colorblindMode == false) {
            this.map.removeLayer(this.diLayer);
          } else if (this.colorblindMode == true) {
            this.map.removeLayer(this.diLayerColorblind);
          }
        }
      } else if (id == "pred") {
        if (!this.checkLayerGetsFoundWithMessage(this.predLayer))
          throw "ERROR - Dieser Layer exisitiert nicht!";
        if (this.predCheckbox == true) {
          if (this.colorblindMode == false) {
            this.predLayer.addTo(this.map);
            this.map.fitBounds(this.predLayer.getBounds());
          } else if (this.colorblindMode == true) {
            this.predLayerColorblind.addTo(this.map);
            this.map.fitBounds(this.predLayerColorblind.getBounds());
          }
        } else if (this.predCheckbox == false) {
          if (this.colorblindMode == false) {
            this.map.removeLayer(this.predLayer);
          } else if (this.colorblindMode == true) {
            this.map.removeLayer(this.predLayerColorblind);
          }
        }
      } else if (id == "aoa") {
        if (!this.checkLayerGetsFoundWithMessage(this.aoaLayer))
          throw "ERROR - Dieser Layer exisitiert nicht!";
        if (this.aoaCheckbox == true) {
          if (this.colorblindMode == false) {
            this.aoaLayer.addTo(this.map);
            this.map.fitBounds(this.aoaLayer.getBounds());
          } else if (this.colorblindMode == true) {
            this.aoaLayerColorblind.addTo(this.map);
            this.map.fitBounds(this.aoaLayerColorblind.getBounds());
          }
        } else if (this.aoaCheckbox == false) {
          if (this.colorblindMode == false) {
            this.map.removeLayer(this.aoaLayer);
          } else if (this.colorblindMode == true) {
            this.map.removeLayer(this.aoaLayerColorblind);
          }
        }
      } else if (id == "samplePolygons") {
        if (!this.checkLayerGetsFoundWithMessage(this.samplePolygonsLayer))
          throw "ERROR - Dieser Layer exisitiert nicht!";
        if (this.samplePolygonsCheckbox == true) {
          this.samplePolygonsLayer.addTo(this.map);
          this.map.fitBounds(this.samplePolygonsLayer.getBounds());
        } else if (this.samplePolygonsCheckbox == false) {
          this.map.removeLayer(this.samplePolygonsLayer);
        }
      } else if (id == "suggestion") {
        if (!this.checkLayerGetsFoundWithMessage(this.suggestionLayer))
          throw "ERROR - Dieser Layer exisitiert nicht!";
        if (this.suggestionCheckbox == true) {
          this.suggestionLayer.addTo(this.map);
          this.map.fitBounds(this.suggestionLayer.getBounds());
        } else if (this.suggestionCheckbox == false) {
          this.map.removeLayer(this.suggestionLayer);
        }
      }
    },
    /**
     * This function focuses the map to the layer where the button gets triggered. It's comparable to the "zoom to layer" function known from common GIS.
     * @param {string} layerId - The layer id is needed to kn ow which layer got triggered.
     */
    zoomToLayer: function (layerId) {
      let tempLayer = null;
      if (layerId == "aoi") tempLayer = this.aoiLayer;
      else if (layerId == "di") tempLayer = this.diLayer;
      else if (layerId == "pred") tempLayer = this.predLayer;
      else if (layerId == "aoa") tempLayer = this.aoaLayer;
      else if (layerId == "samplePolygons")
        tempLayer = this.samplePolygonsLayer;
      else if (layerId == "suggestion") tempLayer = this.suggestionLayer;
      else return;
      this.map.fitBounds(tempLayer.getBounds());
    },
    /**
     * This function builds layers for all .geojson files.
     */
    showGeoJson: async function () {
      const customizedIcon = L.icon({
        iconUrl: markerPng,
        iconSize: [46, 46],
        iconAnchor: [23, 23],
      });

      let responseAoi = null;
      let responseSamplePolygons = null;
      let responseSuggestion = null;

      try {
        responseAoi = await API.getJobFile(this.jobId, this.aoiJson);
      } catch (err) {
        console.warn("Unable to load file:", this.aoiJson);
      }
      try {
        responseSamplePolygons = await API.getJobFile(
          this.jobId,
          this.samplePolygonsJson
        );
      } catch (err) {
        console.warn("Unable to load file:", this.samplePolygonsJson);
      }
      try {
        responseSuggestion = await API.getJobFile(
          this.jobId,
          this.suggestionJson
        );
      } catch (err) {
        console.warn("Unable to load file:", this.suggestionJson);
      }

      if (responseAoi) {
        this.aoiLayer = L.geoJson(responseAoi.data);
      }
      if (responseSamplePolygons) {
        this.samplePolygonsLayer = L.geoJson(responseSamplePolygons.data);
      }
      if (responseSuggestion) {
        this.suggestionLayer = L.geoJson(responseSuggestion.data, {
          pointToLayer: function (_feature, latlng) {
            return L.marker(latlng, { icon: customizedIcon });
          },
        });
      }
    },
    /**
     * This function builds layers for all .tif files.
     */
    showTif1Band: async function () {
      let responseDi = null;
      let responseAoa = null;
      let responsePred = null;

      try {
        responseDi = await API.getJobFile(this.jobId, this.diUrl, {
          responseType: "arraybuffer",
        });
      } catch (err) {
        console.warn("Unable to load file:", this.diUrl);
      }
      try {
        responseAoa = await API.getJobFile(this.jobId, this.aoaUrl, {
          responseType: "arraybuffer",
        });
      } catch (err) {
        console.warn("Unable to load file:", this.aoaUrl);
      }
      try {
        responsePred = await API.getJobFile(this.jobId, this.predUrl, {
          responseType: "arraybuffer",
        });
      } catch (err) {
        console.warn("Unable to load file:", this.predUrl);
      }

      if (responseDi) {
        this.georasterDi = await parseGeoraster(responseDi.data);

        const minDi = this.georasterDi.mins[0];
        const rangeDi = this.georasterDi.ranges[0];

        const scaleViridis = chroma.scale("Viridis");
        const colorblindScaleDi = chroma.scale(["yellow", "navy"]).mode("lch");

        this.diLayer = new GeoRasterLayer({
          georaster: this.georasterDi,
          opacity: this.diTransparency,
          pixelValuesToColorFn: function (pixelValues) {
            const [pixelValue] = pixelValues; // there's just one band in this raster
            // if there's zero wind, don't return a color
            if (pixelValue === 0) return null;
            // scale to 0 - 1 used by chroma
            const scaledPixelValue = (pixelValue - minDi) / rangeDi;
            const color = scaleViridis(scaledPixelValue).hex();
            return color;
          },
          resolution: 256,
        });
        this.diLayerColorblind = new GeoRasterLayer({
          georaster: this.georasterDi,
          opacity: this.diTransparency,
          pixelValuesToColorFn: function (pixelValues) {
            const [pixelValue] = pixelValues; // there's just one band in this raster
            // if there's zero wind, don't return a color
            if (pixelValue === 0) return null;
            // scale to 0 - 1 used by chroma
            const scaledPixelValue = (pixelValue - minDi) / rangeDi;
            const color = colorblindScaleDi(scaledPixelValue).hex();
            return color;
          },
          resolution: 256,
        });
      }

      if (responseAoa) {
        this.georasterAoa = await parseGeoraster(responseAoa.data);

        this.aoaLayer = new GeoRasterLayer({
          georaster: this.georasterAoa,
          opacity: this.aoaTransparency,
          pixelValuesToColorFn: function (pixelValues) {
            const pixelValue = pixelValues[0];
            // if there's zero wind, don't return a color
            if (pixelValue === 1) {
              return null;
            }
            return "#cf1f8f";
          },
          resolution: 256,
        });
        this.aoaLayerColorblind = new GeoRasterLayer({
          georaster: this.georasterAoa,
          opacity: this.aoaTransparency,
          pixelValuesToColorFn: function (pixelValues) {
            const pixelValue = pixelValues[0];
            // if there's zero wind, don't return a color
            if (pixelValue === 1) {
              return null;
            }
            return "#21A7E6";
          },
          resolution: 256,
        });
      }
      // Needs to be colored:
      if (responsePred) {
        this.georasterPred = await parseGeoraster(responsePred.data);

        this.predLayer = new GeoRasterLayer({
          georaster: this.georasterPred,
          opacity: this.predTransparency,
          pixelValuesToColorFn: (pixelValues) =>
            this.predClassificationColors[pixelValues[0] - 1] || null,
          resolution: 256,
        });
        this.predLayerColorblind = new GeoRasterLayer({
          georaster: this.georasterPred,
          opacity: this.predTransparency,
          pixelValuesToColorFn: (pixelValues) =>
            this.colorblindScalePred[pixelValues[0] - 1] || null,
          resolution: 256,
        });
      }
    },
    /**
     * This function loads the given result.json asynchronious, which gives us the possibility to work with this given values including
     * the accuracy and the dissimilarity index as resulting values from the processing as well as the the classes from the classification used
     * to color the resultig GeoTiff.
     */
    loadResultJson: async function () {
      let responseResult = null;

      try {
        responseResult = await API.getJobFile(this.jobId, this.resultJsonUrl);
      } catch (err) {
        console.warn("Unable to load file:", this.resultJsonUrl);
      }

      if (!responseResult) {
        return;
      }

      this.accuracy = responseResult.data[1];
      this.kappaIndex = responseResult.data[2];
      this.resultJson = responseResult.data;

      // Generate classification colors with chromajs
      this.predClassificationColors = chroma
        .scale("Spectral")
        .colors(this.resultJson[0].length);

      this.colorblindScalePred = chroma
        .scale("RdYlBu")
        .colors(this.resultJson[0].length);
    },
  },
  async mounted() {
    this.$store.dispatch("getJobById", this.jobId);

    this.initMap();
    await this.loadResultJson();
    this.showTif1Band();
    this.showGeoJson();
  },
  beforeUnmount() {
    if (this.map) {
      this.map.remove();
    }
  },
};
</script>
<style scoped>
body {
  text-align: center;
}
td {
  height: 90px;
}
#td_elements_with_slider {
  padding-top: 15px;
  padding-bottom: 5px;
}
tr#not_last_td {
  border-bottom: grey;
}
tr#last_td {
  border-bottom: grey;
}
.child {
  display: inline-block;
}

#download_b {
  padding-top: 17px;
}
.download_button {
  justify-content: center;
  align-items: center;
  flex-wrap: nowrap;
  position: relative;
}
#control.table {
  display: block;
  /* DOENST WORK BUT THE TARGET WAS A CENTER ALIGNED LAYER CONTROL FOR THE RESPONSIVE DESIGN */
  margin-left: auto;
  margin-right: auto;
}
.layer-column {
  flex: auto;
}
#map-container {
  width: 100%;
  height: 500px;
}
@media (min-width: 1264px) {
  .wrapper {
    flex: 1;
    height: 100%;
    min-height: 0;
    overflow: hidden;
  }
  .layer-column {
    height: 100%;
    position: relative;
    overflow-y: auto;
    overflow-x: hidden;
    min-height: 0;
    min-width: 410px;
    max-width: 410px;
  }
  #map-container {
    width: 100%;
    height: 100%;
  }
}
</style>
